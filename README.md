
| unit tests    | [![test-suite](https://github.com/ClemensHoischen/iact-observation-planner/actions/workflows/github-pytest.yml/badge.svg?branch=main)](https://github.com/ClemensHoischen/iact-observation-planner/actions/workflows/github-pytest.yml)|
| ------------- | ------------- |
| code coverage | [![codecov](https://codecov.io/gh/ClemensHoischen/iact-observation-planner/branch/main/graph/badge.svg?token=AKR7Z76CGV)](https://codecov.io/gh/ClemensHoischen/iact-observation-planner)|
# DISCLAIMER
**This package is not yet available on PyPI and is still in development.**
**Get in touch if you would like to help. Apart from that: Feel free to play around with it.**


# iact observation planner

This is a tool to quickly evaluate different constraints for planning observations with iacts. different sites, darkness conditions are supported. multiple targets with individual target hours and altitude limits are supported.

## Installation
The tool is in development with `python3.8` so you might want to setup a virtual environment with this python version.

Simply clone the repo and install the package with pip:
```
git clone https://github.com/ClemensHoischen/iact-observation-planner.git
cd iact_observation_planner
pip install --user .
```

## Configuring

If you want to use more specific configurations than given by the default, you can make use of the `iop-init <path>` command that comes with this package.

It will copy the default configuration to `<path>`. Applying an environemnt variable to your shell before using the iact-observation-planner will force the tool to read this config.

## Usage
just try `iact-observation-planner --help` for the details of all options.

Example command to plan:
- Eta Carinae with altitude > 30 deg for 2 hours
- PSR B1259-63 with altitude > 30 deg for 5 hours
- starting _2021-03-09_
- for _3_ nights
- using the _dark_ darkness definition
- on the _HESS_ site

`iact-observation-planner --target "Eta Carinae;30;2" "PSR B1259-63;30;5" -d 2021-03-09 -r 3 -o dark -s HESS`

The resulting output is:

```
Planning the following targets:
Eta Carinae     : 10h45m03.5455s -59d41m03.9511s - (ra = 161.26 deg = -59.68 deg)
                  Altitude > 30.0 deg
                  Target observation time = 2
PSR B1259-63    : 13h02m47.6542s -63d50m08.6259s - (ra = 195.70 deg = -63.84 deg)
                  Altitude > 30.0 deg
                  Target observation time = 5
Boundry Conditions:
 * Site:       HESS
 * Darkness:   {'max_sun_altitude': '-16 deg', 'max_moon_altitude': '-0.5 deg', 'max_moon_phase': False, 'min_moon_distance': False}
 * Start Date: 2021-03-09
 * N nights:   3

Evening Date: 2021-03-09
 * Eta Carinae: from 18:22:49 to 01:57:01  culmination at 22:29:47
 * PSR B1259-63: from 20:13:32 to 01:57:01  culmination at 00:46:03
Evening Date: 2021-03-10
 * Eta Carinae: from 18:21:49 to 02:54:09  culmination at 22:26:36
 * PSR B1259-63: from 20:09:58 to 02:54:09  culmination at 00:43:13
Evening Date: 2021-03-11
 * Eta Carinae: from 18:20:48 to 03:00:11  culmination at 22:20:31
 * PSR B1259-63: from 20:06:24 to 03:48:42  culmination at 00:40:21
```

Note that this represents the current output, and e.g. the target hours per target is not being used as of yet.


## Ideas
Some ideas for further development
### suggested observation times
The tool should suggest (at least) two kinds of time allocations:
- the earliest possible observation time up to the spcified hours per target
- the time range optimized for highest altitude

###  darkness evaluation
The darkness definition should be linked with the [nsb](https://pypi.org/project/nsb/) tool.

### plotting
A nice plot of the nights and suggested observation times per target would be nice.

### output/input
The output could be generated by default in a nice format (maybe json?)
the target input is a bit hacky right now and could be replaced by little json file input.

## Acknowledgements

Parts of this project are based on the the [hessobs](https://github.com/kosack/hessobs) project by @kosack.
